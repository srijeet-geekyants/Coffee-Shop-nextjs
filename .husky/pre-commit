# safer defaults
set -Eeuo pipefail

# helpers for styled output (use printf to avoid echo quirks)
info()    { printf "\033[1;34mâ„¹ï¸  %s\033[0m\n" "$1"; }
success() { printf "\033[1;32mâœ… %s\033[0m\n" "$1"; }
error()   { printf "\033[1;31mâŒ %s\033[0m\n" "$1"; }

# run a step and hard-fail on non-zero exit
step() {
  desc="$1"; shift
  info "$desc"
  if "$@"; then
    success "$desc â€” OK"
  else
    error "$desc â€” FAILED"
    exit 1
  fi
}

printf "\n"
info "ğŸ” Running pre-commit checksâ€¦"

step "Step 1: Type checking"                 pnpm type:check
step "Step 1b: Checking circular deps"       pnpm type:circular
step "Step 2: Running ESLint"                pnpm lint
step "Step 3: Building project"              pnpm build

printf "\n"
success "ğŸ‰ All pre-commit checks passed!"
printf "\n"
